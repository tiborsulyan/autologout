module.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}([function(t,e){t.exports=flarum.core.compat.app},function(t,e){t.exports=flarum.core.compat.extend},function(t,e){t.exports=flarum.core.compat["common/components/Button"]},function(t,e){t.exports=flarum.core.compat["common/models/User"]},function(t,e){t.exports=flarum.core.compat["components/Page"]},function(t,e){t.exports=flarum.core.compat["components/Modal"]},,,function(t,e,n){"use strict";n.r(e);var o=n(0),i=n.n(o),r=n(3),a=n.n(r),s=n(4),u=n.n(s),l=n(1);function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var d=n(5),f=n.n(d),h=n(2),g=n.n(h),v=function(t){var e,n;function o(){for(var e,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return c(p(e=t.call.apply(t,[this].concat(o))||this),"remainingSeconds",void 0),c(p(e),"remainingTimeString",void 0),c(p(e),"updateInterval",void 0),e}n=t,(e=o).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var i=o.prototype;return i.oninit=function(e){t.prototype.oninit.call(this,e),this.remainingSeconds=this.attrs.remainingTimeMillis/1e3,this.recalculateRemainingTime(),this.updateInterval=setInterval(this.updateRemainingTime.bind(this),1e3)},i.recalculateRemainingTime=function(){var t=Math.floor(this.remainingSeconds/60),e=this.remainingSeconds-60*t;this.remainingTimeString=t+":"+e.toString().padStart(2,"0")},i.updateRemainingTime=function(){this.remainingSeconds--,this.remainingSeconds<0?this.removeTimeUpdater():(this.recalculateRemainingTime(),m.redraw())},i.removeTimeUpdater=function(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null)},i.className=function(){return"ExpirationWarningModal Modal--small"},i.title=function(){return"Figyelmeztetés"},i.content=function(){return m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},m("div",{className:"Modal-header"},m("h3",null,"Mindjárt lejár a munkamenet, mi legyen?"),m("p",null,"Hátralévő idő: ",this.remainingTimeString)),m("div",{className:"Form-group"},g.a.component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading,onclick:this.stay.bind(this)},"Bent maradok"),",",g.a.component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading,onclick:this.leave.bind(this)},"Kilépek"))))},i.onremove=function(){console.log("Removing modal update interval"),this.removeTimeUpdater()},i.onsubmit=function(t){t.preventDefault()},i.stay=function(){app.request({method:"POST",url:app.forum.attribute("baseUrl")+"/api/keepalive"}),this.hide()},i.leave=function(){this.removeTimeUpdater(),app.session.logout()},o}(f.a),b=function(){function t(){c(this,"options",void 0),c(this,"warnTimer",void 0),c(this,"timeoutTimer",void 0)}var e=t.prototype;return e.warn=function(){console.log("Timeout warning!"),app.modal.show(v,{remainingTimeMillis:this.options.timeoutAfter-this.options.warnAfter})},e.timeout=function(){app.session.user&&(console.log("Logging out"),app.session.logout())},e.stop=function(){this.warnTimer&&(clearTimeout(this.warnTimer),this.warnTimer=null),this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)},e.start=function(t){this.options=t,this.warnTimer=setTimeout(this.warn.bind(this),this.options.warnAfter),this.timeoutTimer=setTimeout(this.timeout.bind(this),this.options.timeoutAfter)},e.restart=function(t){this.stop(),this.start(t)},t}();function T(){return{timeoutAfter:6e4*(i.a.forum.attribute("tiborsulyan-autologout.timeoutAfter")||120)-1e4,warnAfter:6e4*(i.a.forum.attribute("tiborsulyan-autologout.warnAfter")||115)-1e4}}i.a.initializers.add("tiborsulyan/autologout",(function(){a.a.prototype.autoLogoutTimer=null,Object(l.extend)(u.a.prototype,"oninit",(function(){i.a.session.user&&(i.a.session.user.autoLogoutTimer?i.a.session.user.autoLogoutTimer.restart(T()):(i.a.session.user.autoLogoutTimer=new b,i.a.session.user.autoLogoutTimer.start(T())))})),Object(l.extend)(XMLHttpRequest.prototype,"open",(function(){this.addEventListener("load",(function(){i.a.session.user&&i.a.session.user.autoLogoutTimer&&i.a.session.user.autoLogoutTimer.restart(T())}))}))}))}]);
//# sourceMappingURL=forum.js.map